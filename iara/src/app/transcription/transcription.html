<div class="bg-slate-50 min-h-screen p-4 sm:p-6 lg:p-8">
  <div class="max-w-4xl mx-auto">
    
    <header class="mb-6">
      <h1 class="text-3xl sm:text-4xl font-bold text-slate-800 tracking-tight">Transcrição de Áudio</h1>
      <p class="mt-2 text-slate-600">Clique no botão para iniciar a simulação de transcrição de áudio em tempo real.</p>
    </header>
    
    <div *ngIf="keywordError" role="alert" class="mb-6 p-4 border-l-4 rounded-r-lg bg-red-100 border-red-500 text-red-800">
      <p class="font-bold">Atenção</p>
      <p>{{ keywordError }}</p>
    </div>

    <div class="mb-4">
      <button 
        id="startButton"
        (click)="startTranscription()"
        [disabled]="isTranscriptionActive"
        class="px-5 py-2.5 font-semibold text-white rounded-md shadow-md transition-colors duration-300 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 disabled:cursor-not-allowed disabled:shadow-none">
        {{ isTranscriptionActive ? 'Transcrevendo...' : 'Iniciar Transcrição' }}
      </button>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-6 p-4 border rounded-lg bg-slate-100">
      <div>
        <label for="filter" class="block text-sm font-medium text-slate-700 mb-1">Filtrar Transcrições</label>
        <input type="text" id="filter" [(ngModel)]="filterText" placeholder="Digite para buscar..." class="w-full p-2 border border-slate-300 rounded-md shadow-sm">
      </div>

      <div class="flex items-center">
          <button (click)="exportToTxt()" [disabled]="displayedTranscriptions.length === 0 || isTranscriptionActive" class="w-full text-sm font-medium text-blue-700 hover:text-blue-900 disabled:text-slate-400 disabled:cursor-not-allowed">Exportar para .TXT</button>
      </div>
    </div>

    <div class="h-[60vh] w-full rounded-lg border bg-white overflow-y-auto">
        <div 
            *ngFor="let item of filteredTranscriptions; trackBy: trackBySegmentId" 
            class="p-4 border-b border-slate-200">
            
            <div *ngIf="item.isLoading; else content" class="animate-pulse flex space-x-4">
              <div class="flex-1 space-y-3 py-1"><div class="h-2 bg-slate-200 rounded"></div><div class="grid grid-cols-3 gap-4"><div class="h-2 bg-slate-200 rounded col-span-2"></div><div class="h-2 bg-slate-200 rounded col-span-1"></div></div></div>
            </div>

            <ng-template #content>
              <p class="text-slate-700">
                <b class="text-slate-900 mr-2">Segmento {{ item.segmentId + 1 }}:</b>
                <span *ngFor="let part of item.parts">
                  <span [class.bg-yellow-200]="part.isKeyword" [class.font-medium]="part.isKeyword" [class.text-yellow-900]="part.isKeyword" class="rounded px-1 py-0.5">{{ part.text }}</span>
                </span>
              </p>
            </ng-template>

        </div>
    </div>

  </div>
</div>